(function(e){function t(t){for(var o,a,i=t[0],u=t[1],c=t[2],p=0,d=[];p<i.length;p++)a=i[p],s[a]&&d.push(s[a][0]),s[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);l&&l(t);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,i=1;i<n.length;i++){var u=n[i];0!==s[u]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},s={app:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/sso/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var l=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1552:function(e,t,n){"use strict";var o=n("7582"),s=n.n(o);s.a},1806:function(e,t,n){"use strict";var o=n("8530"),s=n.n(o);s.a},3741:function(e,t,n){"use strict";var o=n("d499"),s=n.n(o);s.a},"3ee0":function(e,t,n){e.exports=n.p+"img/bg.5825f033.svg"},"4ecf":function(e,t,n){"use strict";var o=n("a828"),s=n.n(o);s.a},"4ffd":function(e,t,n){e.exports=n.p+"img/logo.ebdb1c15.png"},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var o,s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",{staticClass:"dev-article-bg",style:{backgroundImage:"url("+e.bgUrl+")"}},[n("NavBar"),n("Content",[n("router-view")],1)],1)},a=[],i=n("3ee0"),u=n.n(i),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Header",{staticClass:"dev-header"},[n("div",{staticClass:"layout-logo",style:{backgroundImage:"url("+e.logoImg+")"}}),n("div",{staticClass:"layout-logo-title"},[n("span",{staticClass:"logo-title"},[e._v("单点登录系统")])])])},l=[],p=n("4ffd"),d=n.n(p),f={data:function(){return{logoImg:d.a}}},h=f,m=(n("1806"),n("2877")),g=Object(m["a"])(h,c,l,!1,null,"3b2fc69a",null),v=g.exports,b={components:{NavBar:v},data:function(){return{bgUrl:u.a,uagAppId:this.$route.query.uagAppId,uagAccessToken:this.$route.query.uagAccessToken}},mounted:function(){this.checkSsoParam(),this.initDeviceToken()},methods:{initDeviceToken:function(){"undefined"===typeof localStorage.deviceToken&&this.utils.netUtil.postWithAccessToken(this.uagAppId,this.uagAccessToken,this.API_PTAH.authInitializeDevice,{},function(e){localStorage.setItem("deviceToken",e.data.datas)})},checkSsoParam:function(){"undefined"!==typeof this.uagAppId&&"undefined"!==typeof this.uagAccessToken?this.routeLoginCardByLoginType():this.$router.push("/err")},routeLoginCardByLoginType:function(){var e=this;this.utils.netUtil.postWithAccessToken(this.uagAppId,this.uagAccessToken,this.API_PTAH.authGetCurrentAppInfo,{},function(t){"0"==t.data.errCode?(sessionStorage.setItem("uagAppId",e.uagAppId),sessionStorage.setItem("uagAccessToken",e.uagAccessToken),"1"==t.data.datas?e.$router.push("/sms"):e.$router.push("/password")):e.$router.push("/err")})}}},w=b,k=(n("3741"),Object(m["a"])(w,r,a,!1,null,"446f9194",null)),y=k.exports,T=n("e069"),A=n.n(T),I=(n("dcad"),n("8b5e"),n("96cf"),n("3b8d")),S=n("bc3a"),C=n.n(S),P={},L=C.a.CancelToken;C.a.interceptors.request.use(function(e){return P[e.url]?(P[e.url]("操作取消"),P[e.url]=o):P[e.url]=o,e},function(e){return Promise.reject(e)}),C.a.interceptors.response.use(function(e){return e},function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="错误请求";break;case 401:e.message="未授权，请重新登录";break;case 403:e.message="拒绝访问";break;case 404:e.message="请求错误,未找到该资源";break;case 405:e.message="请求方法未允许";break;case 408:e.message="请求超时";break;case 500:e.message="服务器端出错";break;case 501:e.message="网络未实现";break;case 502:e.message="网络错误";break;case 503:e.message="服务不可用";break;case 504:e.message="网络超时";break;case 505:e.message="http版本不支持该请求";break;default:e.message="连接错误".concat(e.response.status)}else e.message="连接到服务器失败";return T["Message"].error(e.message),Promise.resolve(e.response)}),C.a.defaults.baseURL="",C.a.defaults.headers={"Content-Type":"application/json",Accept:"application/json"},C.a.defaults.timeout=1e4;var x={postAsync:function(){var e=Object(I["a"])(regeneratorRuntime.mark(function e(t,n){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C()({method:"post",url:t,data:n});case 2:return o=e.sent,e.abrupt("return",o.data.datas);case 4:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),post:function(e,t,n,s){C()({method:"post",url:e,data:t,cancelToken:new L(function(e){o=e})}).then(function(e){"0"===e.data.errCode?n(e):(T["Message"].error("请求失败 错误码 ".concat(e.data.errCode," 错误信息: ").concat(e.data.errMsg)),"undefined"!=typeof s&&s(e))})},postWithAccessToken:function(){var e=Object(I["a"])(regeneratorRuntime.mark(function e(t,n,s,r,a,i){var u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:u={"Content-Type":"application/json",Accept:"application/json",appId:t,accessToken:n},C()({method:"post",url:s,data:r,headers:u,cancelToken:new L(function(e){o=e})}).then(function(e){"0"===e.data.errCode?a(e):(T["Message"].error("请求失败 错误码 ".concat(e.data.errCode," 错误信息: ").concat(e.data.errMsg)),"undefined"!=typeof i&&i(e))});case 2:case"end":return e.stop()}},e)}));function t(t,n,o,s,r,a){return e.apply(this,arguments)}return t}()},F=n("7618"),D={copyObj:function(e){var t,n={};for(t in e)n[t]=e[t];return n},uniqueArray:function(e){for(var t=[e[0]],n=1;n<e.length;n++){for(var o=e[n],s=!1,r=0;r<t.length;r++)if(o===t[r]){s=!0;break}s||t.push(o)}return t},removeEmptyValueInArray:function(e){for(var t=0;t<e.length;t++)""!=e[t]&&null!=e[t]&&void 0!=Object(F["a"])(e[t])||(e.splice(t,1),t-=1);return this.uniqueArray(e)}};Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)};var _=D,$=(n("28a5"),n("ac6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",[n("i-col",{attrs:{span:"4",offset:"10"}},[n("Card",{staticClass:"login-card",staticStyle:{width:"350px"}},[n("span",{staticClass:"title"},[e._v("  登录账号")]),n("Divider"),n("Form",{ref:"smsLoginFrom",attrs:{"label-position":"top",model:e.smsLoginFrom,rules:e.smsLoginFromValidate}},[n("FormItem",{attrs:{label:"用户名",prop:"telPhone"}},[n("i-input",{attrs:{type:"text",placeholder:"请输入手机号"},model:{value:e.smsLoginFrom.telPhone,callback:function(t){e.$set(e.smsLoginFrom,"telPhone",t)},expression:"smsLoginFrom.telPhone"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),n("Row",[n("i-col",{attrs:{span:"14"}},[n("FormItem",{attrs:{prop:"smsCode",label:"验证码"}},[n("i-input",{attrs:{type:"text",placeholder:"请输入短信验证码"},model:{value:e.smsLoginFrom.smsCode,callback:function(t){e.$set(e.smsLoginFrom,"smsCode",t)},expression:"smsLoginFrom.smsCode"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1)],1),n("i-col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[e._v(" ")]),n("i-col",{attrs:{span:"8"}},[n("FormItem",[n("CountDownButton",{ref:"countDownButton",attrs:{countDown:e.countDown,showText:e.showText,reShowText:e.reShowText},nativeOn:{click:function(t){return e.sendSmsCode(t)}}})],1)],1)],1),n("FormItem",[n("Button",{attrs:{type:"success",long:""},on:{click:function(t){return e.handleSubmit("smsLoginFrom")}}},[e._v("短信验证码登录")])],1)],1)],1)],1)],1)}),O=[],j=(n("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"count-down-button",attrs:{disabled:e.countDownButtonDisabled,type:"button"}},[e._v(e._s(e.content)+"\n")])}),B=[],M={props:["countDown","showText","reShowText"],data:function(){return{content:this.showText,smsCountDown:this.countDown,countDownButtonDisabled:!1}},computed:{},methods:{changeCountNumber:function(){var e=this;this.countDownButtonDisabled="disabled";var t=setInterval(function(){e.smsCountDown>-1?(e.content=e.smsCountDown,e.smsCountDown--):(e.content=e.reShowText,e.countDownButtonDisabled=!1,clearInterval(t))},1e3)}}},U=M,R=(n("1552"),Object(m["a"])(U,j,B,!1,null,"5f2167ad",null)),E=R.exports,H={name:"SmsCodeLoginCard",components:{CountDownButton:E},data:function(){return{countDown:60,showText:"获取验证码",reShowText:"重新获取",uagAppId:sessionStorage.uagAppId,uagAccessToken:sessionStorage.uagAccessToken,deviceToken:localStorage.deviceToken,smsLoginFrom:{telPhone:"",smsCode:""},smsLoginFromValidate:{telPhone:[{pattern:/^[0-9]{11}$/,required:!0,message:"请输入正确的手机号码",trigger:"blur"}],smsCode:[{pattern:/^[0-9]{4}$/,required:!0,message:"请输入正确格式的验证码",trigger:"blur"}]}}},mounted:function(){this.checkSsoParam()},methods:{sendSmsCode:function(){var e=this,t=/^[0-9]{11}$/,n=this.smsLoginFrom.telPhone;t.test(n)?this.utils.netUtil.postWithAccessToken(this.uagAppId,this.uagAccessToken,this.API_PTAH.authSendLoginSms,{deviceToken:this.deviceToken,telPhone:n},function(t){t.data.datas&&(e.$Message.success("已发送短信验证码"),e.$refs.countDownButton.changeCountNumber())}):this.$Message.error("请输入正确的手机号码!")},checkSsoParam:function(){"undefined"!==typeof this.uagAppId&&"undefined"!==typeof this.uagAccessToken||this.$router.push("/err")},doLogin:function(){var e=this;this.utils.netUtil.postWithAccessToken(this.uagAppId,this.uagAccessToken,this.API_PTAH.authSmsCodeLogin,{deviceToken:this.deviceToken,telPhone:this.smsLoginFrom.telPhone,smsCode:this.smsLoginFrom.smsCode},function(t){if("1"===t.data.datas.loginStatus){var n=t.data.datas.oauthBaseUrl;window.location.href="".concat(n,"?uagDeviceToken=").concat(e.deviceToken)}})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?t.doLogin():t.$Message.error("请完善表单信息!")})}}},q=H,z=(n("ee41"),Object(m["a"])(q,$,O,!1,null,"8b8f02f0",null)),N=z.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",[n("i-col",{attrs:{span:"4",offset:"10"}},[n("Card",{staticClass:"login-card",staticStyle:{width:"350px"}},[n("span",{staticClass:"title"},[e._v("  登录账号")]),n("Divider"),n("Form",{ref:"passwordLoginFrom",attrs:{"label-position":"top",model:e.passwordLoginFrom,rules:e.passwordLoginFromValidate}},[n("FormItem",{attrs:{label:"用户名",prop:"telPhone"}},[n("i-input",{attrs:{type:"text",placeholder:"请输入用户名"},model:{value:e.passwordLoginFrom.telPhone,callback:function(t){e.$set(e.passwordLoginFrom,"telPhone",t)},expression:"passwordLoginFrom.telPhone"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),n("FormItem",{attrs:{label:"密码",prop:"password"}},[n("i-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.passwordLoginFrom.password,callback:function(t){e.$set(e.passwordLoginFrom,"password",t)},expression:"passwordLoginFrom.password"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),n("FormItem",[n("Button",{attrs:{type:"success",disabled:e.commitButtonDisabled,long:""},on:{click:function(t){return e.handleSubmit("passwordLoginFrom")}}},[e._v("账号密码登录")])],1)],1)],1)],1)],1)},W=[],G={name:"SmsCodeLoginCard",data:function(){return{commitButtonDisabled:!1,uagAppId:sessionStorage.uagAppId,uagAccessToken:sessionStorage.uagAccessToken,deviceToken:localStorage.deviceToken,passwordLoginFrom:{telPhone:"",password:""},passwordLoginFromValidate:{telPhone:[{pattern:/^[0-9]{11}$/,required:!0,message:"请输入正确的手机号码",trigger:"blur"}],password:[{required:!0,type:"string",min:5,max:30,message:"密码为长度为5-30之间的字符",trigger:"blur"}]}}},mounted:function(){this.checkSsoParam()},methods:{checkSsoParam:function(){"undefined"!==typeof this.uagAppId&&"undefined"!==typeof this.uagAccessToken||this.$router.push("/err")},doLogin:function(){var e=this;this.commitButtonDisabled="disabled",this.utils.netUtil.postWithAccessToken(this.uagAppId,this.uagAccessToken,this.API_PTAH.authPasswordLogin,{deviceToken:this.deviceToken,telPhone:this.passwordLoginFrom.telPhone,password:this.passwordLoginFrom.password},function(t){if("1"===t.data.datas.loginStatus){var n=t.data.datas.oauthBaseUrl;window.location.href="".concat(n,"?uagDeviceToken=").concat(e.deviceToken)}},function(){e.commitButtonDisabled=!1})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?t.doLogin():t.$Message.error("请完善表单信息!")})}}},J=G,K=(n("68f5"),Object(m["a"])(J,V,W,!1,null,"35bd222b",null)),Q=K.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",[n("i-col",{attrs:{span:"2",offset:"10"}},[n("div",{staticClass:"err-info-box"},[n("P",{staticClass:"err-msg"},[e._v("页面飞到火星去啦")]),n("img",{staticClass:"err-img",attrs:{src:e.errImg404}})],1)])],1)},Y=[],Z=n("8f20"),ee=n.n(Z),te={data:function(){return{errImg404:ee.a}},mounted:function(){},methods:{}},ne=te,oe=(n("4ecf"),Object(m["a"])(ne,X,Y,!1,null,"456f3154",null)),se=oe.exports,re=n("8c4f");s["default"].use(re["a"]);var ae={};ae.routerPath=[{path:"/sms",component:N,icon:"ios-appstore",name:"短信验证码登录"},{path:"/password",component:Q,icon:"ios-appstore",name:"账号密码登录"},{path:"/err",component:se,icon:"ios-appstore",name:"错误页面"},{path:"",redirect:"/sms"}],ae.initRouterGenerate=new re["a"]({routes:ae.routerPath});var ie=ae,ue={initRouterTreeNameArr:function(e){var t=[],n=[];e.split("/").forEach(function(e){""!=e&&t.push("/"+e)}),t.pop(),t.push(e);var o=e;while(o.split("/").length-1>1)o=o.slice(0,o.lastIndexOf("/")),t.push(o);return t=_.removeEmptyValueInArray(t),ie.routerPath.forEach(function(e){t.forEach(function(t){var o=!1;e.path.indexOf(":")>0&&e.path.slice(0,e.path.indexOf(":"))===t.slice(0,t.lastIndexOf("/")+1)&&(o=!0),e.path===t&&(o=!0),o&&n.push(e)})}),n},getPcUrlByRouterPath:function(e){var t="",n=JSON.parse(localStorage.menuArr);return n.map(function(n){n.path===e&&(t=n.pcUrl)}),t},getMenuListFromLocalRouterConfig:function(){var e=JSON.parse(localStorage.menuArr);return e.splice(0,1),e}},ce=ue,le={sendAutoParentFrameSizeMsg:function(){setInterval(function(){var e=window.document.body.offsetHeight;window.parent.postMessage({subFrameHeight:e},"*")},500)},reSizeParentFrameSize:function(e){window.addEventListener("message",function(t){var n=t.data.subFrameHeight;"undefined"!=typeof n&&(n="".concat(n,"px"),e.commit("reSizeFrameHeight",n))},!1)}},pe=le,de={netUtil:x,objectUtil:_,frameUtil:pe,routerUtil:ce},fe=de,he={authSendLoginSms:"/auth/sendLoginSms",authInitializeDevice:"/auth/initializeDevice",authSmsCodeLogin:"/auth/smsCodeLogin",authPasswordLogin:"/auth/passwordLogin",authGetCurrentAppInfo:"/auth/getCurrentAppInfo"},me=he,ge=n("2f62"),ve={},be=ve,we={},ke=we;s["default"].use(ge["a"]);var ye={};ye.initsStoreInstance=new ge["a"].Store({state:be,mutations:ke});var Te=ye,Ae=n("2b27"),Ie=n.n(Ae);s["default"].use(A.a),s["default"].use(Ie.a),s["default"].config.productionTip=!1,fe.vue=void 0,s["default"].prototype.utils=fe,s["default"].prototype.API_PTAH=me;var Se=ie.initRouterGenerate,Ce=Te.initsStoreInstance;new s["default"]({router:Se,store:Ce,render:function(e){return e(y)}}).$mount("#app")},"5e54":function(e,t,n){},"68f5":function(e,t,n){"use strict";var o=n("5e54"),s=n.n(o);s.a},7582:function(e,t,n){},8530:function(e,t,n){},8915:function(e,t,n){},"8b5e":function(e,t,n){},"8f20":function(e,t,n){e.exports=n.p+"img/404.2361d16e.png"},a828:function(e,t,n){},d499:function(e,t,n){},ee41:function(e,t,n){"use strict";var o=n("8915"),s=n.n(o);s.a}});
//# sourceMappingURL=app.b03d4967.js.map